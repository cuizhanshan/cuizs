(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9ac3c40a"],{2423:function(t,e,a){"use strict";a.d(e,"c",(function(){return i})),a.d(e,"b",(function(){return r})),a.d(e,"d",(function(){return l})),a.d(e,"a",(function(){return o})),a.d(e,"e",(function(){return c}));var n=a("b775");function i(t){return Object(n["a"])({url:"/vue-element-admin/article/list",method:"get",params:t})}function r(t){return Object(n["a"])({url:"/vue-element-admin/article/detail",method:"get",params:{id:t}})}function l(t){return Object(n["a"])({url:"/vue-element-admin/article/pv",method:"get",params:{pv:t}})}function o(t){return Object(n["a"])({url:"/vue-element-admin/article/create",method:"post",data:t})}function c(t){return Object(n["a"])({url:"/vue-element-admin/article/update",method:"post",data:t})}},"5ff2":function(t,e,a){},ca5f:function(t,e,a){"use strict";a("5ff2")},d06e:function(t,e,a){"use strict";a("fd7c")},d40a:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"app-container"},[a("div",{staticStyle:{"margin-bottom":"15px"}},[a("el-button",{attrs:{type:"success",size:"mini"},on:{click:t.handleAdd}},[t._v("新增")]),a("el-button",{attrs:{type:"danger",disabled:0===t.multipleSelection.length,size:"mini"},on:{click:t.deleteMultple}},[t._v("删除选中")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],ref:"dragTable",staticStyle:{width:"100%"},attrs:{data:t.list,"row-key":"id",border:"",fit:"","highlight-current-row":""},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",align:"center"}}),a("el-table-column",{attrs:{align:"center",label:"名称"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("span",[t._v(t._s(n.title))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"图片"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("img",{staticClass:"banner_img",attrs:{"data-src":t.getImageUrl(n.picId,n),src:"",id:"table_img_"+n.picId,alt:"",srcset:""}})]}}])}),a("el-table-column",{attrs:{align:"center",label:"显示"},scopedSlots:t._u([{key:"default",fn:function(t){var e=t.row;return[a("el-switch",{attrs:{value:e.display,"active-value":1,"inactive-value":0}})]}}])}),a("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("el-tooltip",{attrs:{content:"编辑",placement:"left",effect:"dark"}},[a("svg-icon",{staticClass:"drag-handler",attrs:{"icon-class":"edit"},on:{click:function(e){return t.handleEdit(n)}}})],1),a("el-tooltip",{attrs:{content:"删除",placement:"left",effect:"dark"}},[a("svg-icon",{staticClass:"drag-handler",attrs:{"icon-class":"delete"},on:{click:function(e){return t.deleteBanner(n.id)}}})],1)]}}])})],1)],1),a("FormDialog",{attrs:{visible:t.dialogVisible,mode:t.dialogMode,dataSource:t.dialogDataSource||{}}})],1)},i=[],r=a("5530"),l=a("1da1"),o=(a("96cf"),a("d81d"),a("fb6a"),a("d3b7"),a("a15b"),a("a434"),a("ac1f"),a("466d"),a("99af"),a("4de4"),a("2423"),a("b775")),c=a("83d6");function s(t){return Object(o["a"])({url:"".concat(c["baseUrl"],"/inspection/banner"),method:"post",data:t})}function u(t){return Object(o["a"])({url:"".concat(c["baseUrl"],"/inspection/banner"),method:"PUT",data:t,headers:{"Content-Type":"application/json"}})}function d(t){return Object(o["a"])({url:"".concat(c["baseUrl"],"/inspection/banner/list"),method:"POST",data:t,headers:{"Content-Type":"application/json"}})}function f(t){return Object(o["a"])({url:"".concat(c["baseUrl"],"/inspection/banner/").concat(t),method:"DELETE",headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function p(t){return Object(o["a"])({url:"".concat(c["baseUrl"],"/inspection/pic"),method:"post",data:t,headers:{"content-type":"multipart/form-data"}})}function m(t){return Object(o["a"])({url:"".concat(c["baseUrl"],"/inspection/pic/").concat(t),method:"GET",data:t,headers:{"content-type":"application/x-www-form-urlencoded"}})}var b=a("53fe"),g=a.n(b),h=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{attrs:{title:"edit"===t.mode?"编辑":"新增",visible:t.visible,width:"40%"},on:{"update:visible":function(e){t.visible=e},close:t.closeDialog}},[a("span",[a("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,inline:!0,size:"small","label-width":"80px"}},[a("el-form-item",{attrs:{label:"展示",prop:"display"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:t.form.display,callback:function(e){t.$set(t.form,"display",e)},expression:"form.display"}})],1),a("el-form-item",{attrs:{label:"名称",prop:"title"}},[a("el-input",{model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),a("el-form-item",{attrs:{label:"图片",prop:"picId"}},[a("span",{staticStyle:{color:"#E8A94E","font-size":"10px"}},[a("i",{staticClass:"el-icon-info"}),a("span",{staticStyle:{"margin-left":"6px"}},[t._v("建议尺寸为120px*168px")])]),a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"","show-file-list":!1,"auto-upload":!1,"on-change":t.uploadImg,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload}},[t.imageUrl?a("img",{staticClass:"avatar",attrs:{src:t.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",{attrs:{label:"链接",prop:"url"}},[a("el-input",{attrs:{disabled:""},model:{value:t.form.url,callback:function(e){t.$set(t.form,"url",e)},expression:"form.url"}})],1),a("el-form-item",{attrs:{label:"排序",prop:"sort"}},[a("el-input",{model:{value:t.form.sort,callback:function(e){t.$set(t.form,"sort",e)},expression:"form.sort"}})],1)],1)],1),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("确认")]),a("el-button",{on:{click:t.closeDialog}},[t._v("取消")])],1)])],1)},v=[],w=(a("3ca3"),a("ddb0"),a("2b3d"),a("61f7")),y={data:function(){return{form:{title:"",sort:0,url:"",display:1,picId:""},imageUrl:"",rules:{title:[{required:!0,message:"请输入名称",trigger:"blur"}],picId:[{required:!0,message:"请上传图片",trigger:"blur"}],display:[{required:!0,message:"请选择开启关闭",trigger:"blur"}]}}},props:{visible:{type:Boolean,require:!0},mode:{type:String,default:"add"},dataSource:{type:Object,default:{}}},mounted:function(){},watch:{visible:function(t){var e=this;console.log("change watch"),t?(this.form=Object(r["a"])({title:"",sort:0,url:"",display:1,picId:""},this.dataSource),this.form.picId&&m(this.form.picId).then((function(t){e.imageUrl="".concat(Object(w["a"])(t.data.suffix)).concat(t.data.pic)}))):(this.form={title:"",sort:0,url:"",display:1,picId:""},this.imageUrl="")}},methods:{closeDialog:function(){this.$parent.closeDialog()},uploadImg:function(t){var e=this,a=new FormData;a.append("pic",t.raw),p(a).then((function(a){e.form.picId=a.data,e.imageUrl=URL.createObjectURL(t.raw)}))},handleAvatarSuccess:function(t,e){this.imageUrl=URL.createObjectURL(e.raw)},beforeAvatarUpload:function(t){var e="image/jpeg"===t.type,a=t.size/1024/1024<2;return e||this.$message.error("上传头像图片只能是 JPG 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),e&&a},onSubmit:function(){var t=this.form;(this.mode="edit")?this.$parent.handleEditBanner(Object(r["a"])({id:this.dataSource.id},t)):this.$parent.handleAddBanner(t)}}},S=y,x=a("2877"),j=Object(x["a"])(S,h,v,!1,null,null,null),k=j.exports,O={name:"DragTable",filters:{statusFilter:function(t){var e={published:"success",draft:"info",deleted:"danger"};return e[t]}},data:function(){return{list:null,total:null,listLoading:!0,listQuery:{page:1,limit:10},sortable:null,oldList:[],newList:[],multipleSelection:[],dialogVisible:!1,dialogMode:"add",dialogDataSource:null}},created:function(){this.getList()},methods:{getList:function(){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.listLoading=!0,e.next=3,d({display:"",title:"",picId:""});case 3:return a=e.sent,n=a.data,t.list=n,t.listLoading=!1,t.oldList=t.list.map((function(t){return t.id})),t.newList=t.oldList.slice(),t.$nextTick((function(){t.setSort()})),e.abrupt("return",Promise.resolve(n));case 11:case"end":return e.stop()}}),e)})))()},handleSelectionChange:function(t){this.multipleSelection=t},deleteMultple:function(){alert("删除".concat(this.multipleSelection.map((function(t){return t.id})).join(",")))},setSort:function(){var t=this,e=this.$refs.dragTable.$el.querySelectorAll(".el-table__body-wrapper > table > tbody")[0];this.sortable=g.a.create(e,{ghostClass:"sortable-ghost",setData:function(t){t.setData("Text","")},onEnd:function(e){console.log(e);var a=t.list.splice(e.oldIndex,1)[0];t.list.splice(e.newIndex,0,a);var n=t.newList.splice(e.oldIndex,1)[0];t.newList.splice(e.newIndex,0,n)}})},handleAdd:function(){this.dialogVisible=!0,this.dialogMode="add",this.dialogDataSource={}},handleEdit:function(t){this.dialogVisible=!0,this.dialogMode="edit",this.dialogDataSource=t},closeDialog:function(){this.dialogVisible=!1},getImageUrl:function(t,e){this.$nextTick(Object(l["a"])(regeneratorRuntime.mark((function a(){var n,i,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n=document.querySelector("#table_img_".concat(e.picId)),!n.src.match("base64")&&"breakSource"!==n.src){a.next=3;break}return a.abrupt("return",!1);case 3:return n.setAttribute("src","breakSource"),a.next=6,m(t);case 6:i=a.sent,r=i.data,n.setAttribute("src","".concat(Object(w["a"])(r.suffix)).concat(r.pic));case 9:case"end":return a.stop()}}),a)}))))},handleAddBanner:function(t){var e=this;s(Object(r["a"])({},t)).then((function(t){e.closeDialog(),e.getList()}))},handleEditBanner:function(t){var e=this;u(Object(r["a"])({},t)).then((function(t){e.closeDialog(),e.getList().then((function(t){e.$nextTick((function(){var a=t.filter((function(t){return t.id===e.dialogDataSource.id}))[0],n=document.querySelector("#table_img_".concat(a.picId));n.setAttribute("src",""),e.getImageUrl(a.picId,a)}))}))}))},deleteBanner:function(t){var e=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){f(t).then((function(t){e.$message({type:"success",message:"删除成功!"}),e.getList()}))})).catch((function(){console.log("取消删除")}))}},components:{FormDialog:k}},_=O,I=(a("ca5f"),a("d06e"),Object(x["a"])(_,n,i,!1,null,"75063988",null));e["default"]=I.exports},fd7c:function(t,e,a){}}]);